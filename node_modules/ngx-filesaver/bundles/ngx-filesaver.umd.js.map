{"version":3,"file":"ngx-filesaver.umd.js.map","sources":["ng://ngx-filesaver/src/filesaver.service.ts","ng://ngx-filesaver/src/filesaver.directive.ts","ng://ngx-filesaver/src/filesaver.module.ts","ng://ngx-filesaver/ngx-filesaver.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { saveAs } from 'file-saver';\n\n@Injectable({ providedIn: 'root' })\nexport class FileSaverService {\n  genType(fileName?: string): string {\n    if (!fileName || fileName.lastIndexOf('.') === -1) return 'text/plain';\n    const type = fileName.substr(fileName.lastIndexOf('.') + 1);\n    switch (type) {\n      case 'txt':\n        return 'text/plain';\n      case 'xml':\n      case 'html':\n        return `text/${type}`;\n      case 'json':\n        return 'octet/stream';\n      default:\n        return `application/${type}`;\n    }\n  }\n\n  save(blob: Blob, fileName?: string, filtType?: string): void {\n    if (!blob) {\n      throw new Error('Muse spcify blod argument');\n    }\n\n    saveAs(new Blob([blob], { type: filtType || blob.type || this.genType(fileName) }), decodeURI(fileName || 'download'));\n  }\n\n  saveText(txt: string, fileName?: string): void {\n    const blob = new Blob([txt]);\n    this.save(blob, fileName);\n  }\n}\n","import {\n  Directive,\n  ElementRef,\n  Input,\n  HostListener,\n  EventEmitter,\n  Output,\n} from '@angular/core';\nimport { HttpClient, HttpParams, HttpResponse } from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\nimport { FileSaverService } from './filesaver.service';\n\n@Directive({\n  selector: '[fileSaver]',\n  exportAs: 'fileSaver'\n})\nexport class FileSaverDirective {\n  @Input() method = 'GET';\n  @Input() http: Observable<HttpResponse<Blob>>;\n  @Input() query: any;\n  @Input() header: any;\n  @Input() url: string;\n  @Input() fileName: string;\n  @Output() readonly success = new EventEmitter<any>();\n  @Output() readonly error = new EventEmitter<any>();\n\n  constructor(\n    private el: ElementRef,\n    private _FileSaverService: FileSaverService,\n    private _httpClient: HttpClient,\n  ) {}\n\n  private getName(res: HttpResponse<Blob>) {\n    return decodeURI(\n      this.fileName ||\n      res.headers.get('filename') ||\n      res.headers.get('x-filename')\n    );\n  }\n\n  @HostListener('click')\n  _click() {\n    let _http = this.http;\n    if (!_http) {\n      const params = new HttpParams(),\n        _data = this.query || {};\n      // tslint:disable-next-line:forin\n      for (const item in _data) {\n        params.set(item, _data[item]);\n      }\n\n      _http = this._httpClient.request(this.method, this.url, {\n        observe: 'response',\n        responseType: 'blob',\n        headers: this.header,\n        params\n      });\n    }\n\n    this.el.nativeElement.disabled = true;\n    _http.subscribe(\n      res => {\n        if (res.status !== 200 || res.body.size <= 0) {\n          this.error.emit(res);\n          return;\n        }\n        this._FileSaverService.save(res.body, this.getName(res));\n        this.success.emit(res);\n      },\n      err => {\n        this.error.emit(err);\n      },\n      () => {\n        this.el.nativeElement.disabled = false;\n      },\n    );\n  }\n}\n","import { NgModule } from '@angular/core';\n\nimport { FileSaverDirective } from './filesaver.directive';\n\n@NgModule({\n  declarations: [FileSaverDirective],\n  exports: [FileSaverDirective],\n})\nexport class FileSaverModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["saveAs","Injectable","EventEmitter","HttpParams","Directive","ElementRef","HttpClient","Input","Output","HostListener","NgModule"],"mappings":"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"}
